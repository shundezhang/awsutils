package awsutils_test

import (
	"testing"

	"github.com/shundezhang/awsutils"
)

func TestVerifyUserInGroup(t *testing.T) {
	token := "eyJraWQiOiJTYnphQU5GWGN1c3lPdG92TENUWGRnSkJPTmRRYkdyQWNrSUVIQWoraUxZPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI3MzU2NDVmNS0wMmUyLTRjZWEtODk4MS1hZjdhMGMyODgxMGYiLCJhdWQiOiI3b3NoNGxoOTRjZzN2ZWtwbGxpcXEzZnV0NSIsImNvZ25pdG86Z3JvdXBzIjpbImFkbWluIl0sImV2ZW50X2lkIjoiMmJlYzdhZDEtOGQ0OS00NmY2LTlmZGYtODA5YTcxM2UzN2E4IiwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE2MDc5MTA3MzEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX1BjZU8zQ21tOCIsImNvZ25pdG86dXNlcm5hbWUiOiI3MzU2NDVmNS0wMmUyLTRjZWEtODk4MS1hZjdhMGMyODgxMGYiLCJleHAiOjE2MDc5MTQzMzEsImlhdCI6MTYwNzkxMDczMSwiZW1haWwiOiJ6aGFuZy5wYXRyaWNrLnNAZ21haWwuY29tIn0.iq8f85obglSBvznTJqVtr71UBlY3BXQvuJ1o5diR5FFuOd-j5u5mYGlKhlNJgv7lz5zN-BFtaW0lYFaC-M6G2lBAS2e93UFEMqeTOISUYcdKelmjlFws6rgL71zxgx2V88iEcA2tBuooTWoZW7KpnpiaFadLY9PYehWzuS5fPdyiq86obns9fiFI1Smqt1T_Z9xQGHZxmvee__nCpSnH2F1-sOTw0CzEbol_2XG02U_7j7ScMscG-cNd4h7-Xu7rafD3_hhhBdPokYJBC6xuWckOqqNjd77DjPjVm2ftq3jA4xOZUAVaoN1kwyOdvljAsSDAKr5cnWAEgSaVUrdlRA"
	groupName := "admin"
	isInGroup := awsutils.VerifyUserInGroup(token, groupName)
	if !isInGroup {
		t.Errorf("user should be in group %v", groupName)
	}
}
